<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Espeak嵌入式移植]]></title>
    <url>%2F2019%2F01%2F28%2FEspeak%2F</url>
    <content type="text"><![CDATA[espeak PC&#x7248;&#x672C;&#x7F16;&#x8BD1;&#x914D;&#x7F6E; &#x4ECB;&#x7ECD; eSpeak is a compact open source software speech synthesizer for English and other languages, for Linux and Windows. http://espeak.sourceforge.net eSpeak uses a &quot;formant synthesis&quot; method. This allows many languages to be provided in a small size. The speech is clear, and can be used at high speeds, but is not as natural or smooth as larger synthesizers which are based on human speech recordings. espeakedit is a GUI program used to prepare and compile phoneme data. It is now available for download. Documentation is currently sparse, but if you want to use it to add or improve language support, let me know. &#x5B98;&#x65B9;&#x4ECB;&#x7ECD; &#x53C2;&#x8003; http://espeak.sourceforge.net/ http://www.uedsc.com/espeak-editor.html https://datahunter.org/espeak &#x4F9D;&#x8D56;&#x5305; espeak-1.48.04 espeakedit-1.48.03 pa_stable_v190600_20161030.tgz //portaudio 19 arm&#x7248;&#x672C;&#x9700;&#x8981; pc&#x7248;&#x672C;&#x4E0D;&#x7528; &#x7F16;&#x8BD1;PC&#x7248;&#x672C;espeak &#x4E0B;&#x8F7D;&#x6E90;&#x7801;&#x5305; espeak&#x4E0B;&#x8F7D;&#x5730;&#x5740; - espeak-1.48.04 &#x4E2D;&#x6587;&#x6570;&#x636E;&#x5305;&#x4E0B;&#x8F7D;&#x5730;&#x5740; - zh_listx.zip &#x7F16;&#x8BD1; &#x4FEE;&#x6539;Makefile cd espeak-1.48.04-source/src#&#x4F7F;&#x7528;&#x7684;&#x662F;19&#x7248;&#x672C;&#x7684;portaudio&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;18&#x7248;&#x672C;&#xFF0C;&#x7F16;&#x8BD1;&#x94FE;&#x63A5;&#x65F6;&#xFF0C;&#x4F1A;&#x627E;&#x4E0D;&#x5230;Pa_IsStreamActive&#x7B49;&#x51FD;&#x6570;&#x5B9A;&#x4E49;cp portaudio19.h portaudio.h emacsclient Makefile &#x6839;&#x636E;&#x81EA;&#x5DF1;&#x7684;PC&#x673A;&#x7684;&#x73AF;&#x5883;&#x9009;&#x62E9;&#x5408;&#x9002;&#x7684;audio&#x5E93; # &apos;runtime&apos; uses pulseaudio if it is running, else uses portaudio#AUDIO = runtime#AUDIO = portaudio#AUDIO = portaudio0#AUDIO = portaudio2AUDIO = pulseaudio#AUDIO = sada &#x7F16;&#x8BD1; makecp espeak-1.48.04-source/espeak-data ~/ #&#x62F7;&#x8D1D;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x5230;&#x7528;&#x6237;home&#x76EE;&#x5F55;espeak-1.48.04-source/src/espeak -vzh+f2 &quot;eric&#xFF0C;&#x4F60;&#x597D;&#x3002;&#x6211;&#x662F;&#x5C0F;E&quot; #-vzh &#x9ED8;&#x8BA4;&#x7537;&#x58F0; -vzh+f2&#x5973;&#x751F; &#x8BE6;&#x7EC6;&#x7684;&#x7684;&#x58F0;&#x97F3;&#x652F;&#x6301;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x76EE;&#x5F55;eric@: ~/espeak-data/voices/!v$ lscroak f1 f2 f3 f4 f5 klatt klatt2 klatt3 klatt4 m1 m2 m3 m4 m5 m6 m7 whisper whisperf &#x6DFB;&#x52A0;&#x5B8C;&#x6574;&#x7684;&#x4E2D;&#x6587;&#x652F;&#x6301; unzip zh_listx.zipcp zh_listx espeak-1.48.04-source/dictsourceespeak-1.48.04-source/src/espeak -compile=zh#&#x53EF;&#x4EE5;&#x5BF9;&#x6BD4;&#x67E5;&#x770B;&#x524D;&#x540E;&#x7684;zh_dict&#x6587;&#x4EF6;&#x5927;&#x5C0F;ls -l ~/espeak-data | grep zh_-rw-r--r-- 1 eric eric 1066907 1&#x6708; 23 10:21 zh_dict &#x7F16;&#x8BD1;PC&#x7248;&#x672C;espeakedit &#x4E0B;&#x8F7D;&#x6E90;&#x7801;&#x5305; espeakedit&#x4E0B;&#x8F7D;&#x5730;&#x5740; - espeakedit-1.48.03 &#x7F16;&#x8BD1; &#x4FEE;&#x6539;Makefile &#x4FEE;&#x6539;LIBS&#x9700;&#x8981;&#x4FEE;&#x6539;&#x6210;&#x5408;&#x9002;&#x7684;&#x97F3;&#x9891;&#x5E93;&#xFF0C;&#x4EE3;&#x7801;&#x4E2D;&#x4F7F;&#x7528;&#x7684;-lportaudio &#x5982;&#x679C;&#x5B58;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x51FA;&#x73B0;ABI&#x7248;&#x672C;&#x95EE;&#x9898; &#x5728;CPPFLAGS&#x4E2D;&#x6DFB;&#x52A0; -fabi-version=2 #LIBS=-lstdc++ -lpulse#LIBS=-lstdc++ -lportaudio#LIBS=-lstdc++ /usr/lib/x86_64-linux-gnu/libportaudio.so.2LIBS=-lstdc++ -lasound -lrt -lasound -lm -lpthread -lportaudio#/home/eric/workspace/portaudio/X64/lib/libportaudio.a -lrt -lasound -lm -lpthreadCPPFLAGS = -fabi-version=2 -Wall -g -fexceptions `wx-config --cflags` &#x7F16;&#x8BD1; #&#x4F7F;&#x7528;&#x7684;&#x662F;19&#x7248;&#x672C;&#x7684;portaudio&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;18&#x7248;&#x672C;&#xFF0C;&#x7F16;&#x8BD1;&#x94FE;&#x63A5;&#x65F6;&#xFF0C;&#x4F1A;&#x627E;&#x4E0D;&#x5230;Pa_IsStreamActive&#x7B49;&#x51FD;&#x6570;&#x5B9A;&#x4E49; cp portaudio19.h portaudio.h &#x79FB;&#x690D;espeak portaudio&#x79FB;&#x690D; &#x5B98;&#x65B9;&#x7F51;&#x7AD9; &#x4E0B;&#x8F7D; pa_stable_v190600_20161030.tgz&#x5E76;&#x89E3;&#x538B; &#x7F16;&#x8BD1; cd portaudio ./configure --preifx=$PWD/BUILD_ARM --host=arm-linux CC=arm-hisiv500-linux-gcc CXX=arm-hisiv500-linux-g++ make ; make install epseak&#x79FB;&#x690D; &#x4FEE;&#x6539;Makefile cd espeak-1.48.04-source/src #&#x4F7F;&#x7528;&#x7684;&#x662F;19&#x7248;&#x672C;&#x7684;portaudio&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;18&#x7248;&#x672C;&#xFF0C;&#x7F16;&#x8BD1;&#x94FE;&#x63A5;&#x65F6;&#xFF0C;&#x4F1A;&#x627E;&#x4E0D;&#x5230;Pa_IsStreamActive&#x7B49;&#x51FD;&#x6570;&#x5B9A;&#x4E49; cp portaudio19.h portaudio.h emacsclient Makefile # &#x4F7F;&#x7528;portaudio0# &apos;runtime&apos; uses pulseaudio if it is running, else uses portaudio#AUDIO = runtime#AUDIO = portaudioAUDIO = portaudio0#AUDIO = portaudio2#AUDIO = pulseaudio#AUDIO = sada &#x7F16;&#x8BD1; makecp espeak-1.48.04-source/espeak-data ~/nfs #&#x62F7;&#x8D1D;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x5230;arm&#x8BBE;&#x5907;cp -rdf espeak libespeak.so* ~/nfs/ ##&#x62F7;&#x8D1D;&#x5E93;&#x6587;&#x4EF6;&#x5230;arm&#x8BBE;&#x5907;espeak --path=/root/nfs/ -vzh+f2 &quot;eric&#xFF0C;&#x4F60;&#x597D;&#x3002;&#x6211;&#x662F;&#x5C0F;E&quot; #arm&#x7EC8;&#x7AEF;&#x8FD0;&#x884C;#&#x5982;&#x679C;&#x8BBE;&#x5907;&#x4E2D;&#x6CA1;&#x6709;&#x5408;&#x9002;&#x7684;audio out&#x8BBE;&#x5907;&#xFF0C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8F93;&#x51FA;&#x97F3;&#x9891;&#x6587;&#x4EF6;,&#x97F3;&#x9891;&#x6587;&#x4EF6;&#x662F; 22050Hz signed 16bit &#x683C;&#x5F0F;&#x7684;wav&#x6587;&#x4EF6;espeak --path=/root/nfs/ -w 1.wav -vzh+f2 &quot;eric&#xFF0C;&#x4F60;&#x597D;&#x3002;&#x6211;&#x662F;&#x5C0F;E&quot; #arm&#x7EC8;&#x7AEF;&#x8FD0;&#x884C; espeak &#x97F3;&#x9891;&#x91CD;&#x91C7;&#x6837; &#x7531;&#x4E8E;espeak&#x9ED8;&#x8BA4;&#x53D1;&#x97F3;&#x97F3;&#x5143;&#x90FD;&#x662F;22050HZ_S16&#x91C7;&#x6837;&#x7387;&#x7684;&#xFF0C;&#x800C;&#x8BBE;&#x5907;&#x7AEF;&#x9ED8;&#x8BA4;&#x662F;8000_U8&#x683C;&#x5F0F;&#xFF0C;&#x9700;&#x8981;&#x505A;&#x91CD;&#x91C7;&#x6837; &#x53C2;&#x8003; https://cloud.tencent.com/developer/article/1094594 https://github.com/mackron/dr_libs/blob/master &#x4FEE;&#x6539;&#x4EE3;&#x7801; &#x53C2;&#x8003;&#x8FD9;&#x4E2A;&#x535A;&#x4E3B;&#x7684;&#x4EE3;&#x7801;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x628A;22050HZ&#x8F6C;&#x4E3A;8000HZ&#xFF0C;&#x518D;&#x62F7;&#x8D1D;&#x4FEE;&#x6539;resampledata&#x51FD;&#x6570;&#x4E2D;&#x7684;int16&#x90E8;&#x5206;&#x7684;&#x5230;resampledata8bit&#x51FD;&#x6570; static void ResampleData8bit(const int16_t *sourceData, int32_t sampleRate, uint32_t srcSize, uint8_t *destinationData,int32_t newSampleRate){ uint32_t last_pos = srcSize - 1; uint32_t dstSize = (uint32_t) (srcSize * ((float) newSampleRate / sampleRate)); for (uint32_t idx = 0; idx &lt; dstSize; idx++) { float index = ((float) idx * sampleRate) / (newSampleRate); uint32_t p1 = (uint32_t) index; float coef = index - p1; uint32_t p2 = (p1 == last_pos) ? last_pos : p1 + 1; destinationData[idx] = (uint8_t) ((1.0f - coef) * (int32_t)sourceData[p1]*0xff/0xffff + coef * (int32_t)sourceData[p2]*0xff/0xffff); }}static void ResamplerBuffer(int16_t *inBuffer, uint32_t inSampleRate, uint32_t inSampleCount, uint32_t outSampleRate, uint8_t **outBuffer, uint32_t *outSampleCount){ if (inBuffer == NULL || inSampleRate &lt;= 0 || inSampleCount &lt;= 0|| outBuffer == NULL || outSampleCount == NULL) { printf(&quot;paramaters error\n&quot;); return; } *outSampleCount = (uint32_t) ((float)inSampleCount * ((float) outSampleRate / inSampleRate)); if (*outSampleCount == 0) { printf(&quot;outsize error %d\n&quot;); return; } *outBuffer = (uint8_t *) malloc(*outSampleCount * sizeof(uint8_t)); if (*outBuffer == NULL) { printf(&quot;malloc buffer failed\n&quot;); return; } ResampleData8bit(inBuffer, inSampleRate, (uint32_t) inSampleCount, *outBuffer, outSampleRate);}]]></content>
      <categories>
        <category>TTS</category>
      </categories>
      <tags>
        <tag>espeak audio resample</tag>
      </tags>
  </entry>
</search>
